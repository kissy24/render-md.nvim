# 仕様書：render-md.nvim

## 1. 概要
`render-md.nvim` は、Neovim 内で Markdown ファイルを Notion のようなスタイルでリアルタイムにレンダリングするプラグインです。編集中のテキストを解析し、装飾（Conceal、Virtual Text、Extmarks）を用いることで、プレビューウィンドウを別に開くことなく、バッファ上で直接リッチな表示を実現します。

## 2. 主な機能
- **リアルタイム・レンダリング**: タイピングに合わせて即座に装飾が更新される。
- **Notionライクな装飾**:
    - 見出し（H1, H2, H3）の背景色やアイコン付与。
    - 箇条書きリストのドットをカスタムアイコン（•, ◦等）に置換。
    - 引用ブロック（Blockquote）のサイドバー表示。
    - コードブロックの背景色変更とプログラム言語アイコンの表示。
    - インライン装飾（太字、斜体、打ち消し線）の記号を隠し、装飾のみを表示（Conceal機能）。
    - チェックボックス（タスクリスト）のアイコン化。
- **動的切り替え**: コマンドによりレンダリングの有効/無効を切り替え可能。
- **Treesitter連携**: 高精度な構文解析に基づいたレンダリング。

## 3. 技術スタック
- **言語**: Lua (Neovim 0.9.0以上推奨)
- **依存関係**:
    - `nvim-treesitter`: Markdownのパースに使用。
    - `nvim-web-devicons` (任意): アイコン表示に使用。
- **Neovim API**:
    - `nvim_buf_set_extmark`: 装飾、背景色、バーチャルテキストの付与。
    - `conceal`: 記号の非表示化。
    - `autocmd` (`TextChanged`, `TextChangedI`): リアルタイム更新のトリガー。

## 4. 画面設計イメージ
- `# Header 1` -> 大きなフォント（または目立つ背景）の **Header 1**
- `- [ ] Task` -> `☐ Task`
- `> Quote` -> 縦棒付きの `Quote`

## 5. 今後の拡張予定
- テーブルの罫線表示の最適化。
- 数式（LaTeX）のプレビュー表示。
- 画像リンクのプレビュー（画像プロトコル対応ターミナル限定）。

## 6. 実装フェーズ
1. **Phase 1**: 基本構造の作成とTreesitterによるパースの確認。
2. **Phase 2**: 基本的な装飾（見出し、リスト、太字）の実装。
3. **Phase 3**: リアルタイム更新（オートコマンド）の実装。
4. **Phase 4**: 高度な装飾（コードブロック、引用、タスクリスト）の実装。
5. **Phase 5**: 設定オプションとコマンドの追加。
